<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Omni Tracker â€” Changelog & Demos</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Mono:wght@400;500&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  /* â”€â”€ Reset & Base â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg:          #0d0e11;
    --surface:     #13151a;
    --surface2:    #1a1d24;
    --border:      #252830;
    --border2:     #2e323d;
    --text:        #e8eaf0;
    --text-muted:  #7a7f8e;
    --text-faint:  #454a57;
    --accent:      #ff4d6d;
    --accent2:     #7c6af7;
    --accent3:     #00d4aa;
    --tag-bg:      #1e2030;
    --tag-text:    #9ba3c0;
    --pill-bg:     #1a1d24;
    --pill-active: #ff4d6d;
    --pill-active-text: #fff;
    --radius:      8px;
    --radius-lg:   14px;
  }

  html { scroll-behavior: smooth; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    line-height: 1.6;
    min-height: 100vh;
  }

  /* â”€â”€ Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .app {
    display: grid;
    grid-template-columns: 260px 1fr;
    grid-template-rows: 56px 1fr;
    min-height: 100vh;
  }

  /* â”€â”€ Topbar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .topbar {
    grid-column: 1 / -1;
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    padding: 0 24px;
    gap: 20px;
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .logo {
    font-family: 'DM Serif Display', serif;
    font-size: 18px;
    color: var(--text);
    letter-spacing: -0.3px;
    flex-shrink: 0;
  }
  .logo em { color: var(--accent); font-style: normal; }

  .topbar-search {
    flex: 1;
    max-width: 480px;
    position: relative;
  }
  .topbar-search input {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border2);
    border-radius: var(--radius);
    padding: 7px 12px 7px 34px;
    color: var(--text);
    font-family: inherit;
    font-size: 13px;
    outline: none;
    transition: border-color 0.2s;
  }
  .topbar-search input:focus { border-color: var(--accent2); }
  .topbar-search input::placeholder { color: var(--text-faint); }
  .topbar-search .search-icon {
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-faint);
    pointer-events: none;
  }

  .topbar-tabs {
    display: flex;
    gap: 4px;
    margin-left: auto;
  }
  .topbar-tab {
    padding: 6px 14px;
    border-radius: var(--radius);
    cursor: pointer;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-muted);
    border: none;
    background: transparent;
    transition: all 0.15s;
  }
  .topbar-tab:hover { color: var(--text); background: var(--surface2); }
  .topbar-tab.active { background: var(--accent); color: #fff; }

  .scrape-badge {
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    color: var(--text-faint);
    flex-shrink: 0;
  }

  /* â”€â”€ Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .sidebar {
    background: var(--surface);
    border-right: 1px solid var(--border);
    overflow-y: auto;
    padding: 16px 0;
    position: sticky;
    top: 56px;
    height: calc(100vh - 56px);
  }

  .sidebar-section {
    padding: 0 16px 16px;
    border-bottom: 1px solid var(--border);
    margin-bottom: 8px;
  }

  .sidebar-label {
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--text-faint);
    padding: 8px 0 8px;
    display: block;
  }

  /* Author pills */
  .author-pills {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }
  .author-pill {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 5px 8px;
    border-radius: var(--radius);
    cursor: pointer;
    border: none;
    background: transparent;
    color: var(--text-muted);
    font-family: inherit;
    font-size: 12px;
    text-align: left;
    transition: all 0.15s;
    width: 100%;
  }
  .author-pill:hover { background: var(--surface2); color: var(--text); }
  .author-pill.active { background: var(--accent2); color: #fff; }
  .author-avatar {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: var(--border2);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 9px;
    font-weight: 700;
    color: var(--text-muted);
    flex-shrink: 0;
  }
  .author-pill.active .author-avatar { background: rgba(255,255,255,0.2); color: #fff; }
  .author-count {
    margin-left: auto;
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    opacity: 0.6;
  }

  /* Tag filter pills */
  .tag-pills {
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
  }
  .tag-pill {
    padding: 3px 9px;
    border-radius: 20px;
    background: var(--tag-bg);
    color: var(--tag-text);
    font-size: 11px;
    cursor: pointer;
    border: 1px solid transparent;
    transition: all 0.15s;
  }
  .tag-pill:hover { border-color: var(--border2); color: var(--text); }
  .tag-pill.active { background: var(--accent2); color: #fff; border-color: var(--accent2); }

  /* Clear filters */
  .clear-filters {
    display: none;
    width: 100%;
    padding: 7px;
    background: transparent;
    border: 1px dashed var(--border2);
    border-radius: var(--radius);
    color: var(--text-faint);
    font-family: inherit;
    font-size: 12px;
    cursor: pointer;
    margin-top: 8px;
    transition: all 0.15s;
  }
  .clear-filters:hover { border-color: var(--accent); color: var(--accent); }
  .clear-filters.visible { display: block; }

  /* â”€â”€ Main content â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .main {
    overflow-y: auto;
    padding: 24px 32px;
    max-width: 960px;
  }

  /* â”€â”€ Stats bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .stats-bar {
    display: flex;
    gap: 20px;
    margin-bottom: 28px;
    padding: 14px 20px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
  }
  .stat {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }
  .stat-value {
    font-family: 'DM Mono', monospace;
    font-size: 22px;
    font-weight: 500;
    color: var(--text);
    letter-spacing: -0.5px;
  }
  .stat-label {
    font-size: 11px;
    color: var(--text-faint);
    text-transform: uppercase;
    letter-spacing: 0.06em;
  }
  .stat + .stat { padding-left: 20px; border-left: 1px solid var(--border); }

  /* â”€â”€ Result count â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .result-meta {
    font-size: 12px;
    color: var(--text-faint);
    margin-bottom: 16px;
    font-family: 'DM Mono', monospace;
  }
  .result-meta strong { color: var(--accent); font-weight: 500; }

  /* â”€â”€ Week card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .week-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    margin-bottom: 16px;
    overflow: hidden;
    transition: border-color 0.2s;
  }
  .week-card:hover { border-color: var(--border2); }
  .week-card.hidden { display: none; }

  .week-header {
    padding: 14px 18px;
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    user-select: none;
  }
  .week-header:hover { background: var(--surface2); }

  .week-date {
    font-family: 'DM Mono', monospace;
    font-size: 11px;
    color: var(--accent);
    flex-shrink: 0;
    min-width: 85px;
  }
  .week-title {
    flex: 1;
    font-size: 13px;
    font-weight: 500;
    color: var(--text);
    line-height: 1.4;
  }
  .week-meta {
    display: flex;
    gap: 6px;
    align-items: center;
    flex-shrink: 0;
  }
  .week-count {
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    color: var(--text-faint);
    background: var(--surface2);
    padding: 2px 7px;
    border-radius: 10px;
  }
  .chevron {
    color: var(--text-faint);
    transition: transform 0.2s;
    font-size: 12px;
  }
  .week-card.open .chevron { transform: rotate(90deg); }

  .week-authors-preview {
    display: flex;
    gap: 4px;
    flex-wrap: wrap;
  }
  .mini-author {
    font-size: 10px;
    padding: 1px 6px;
    background: var(--tag-bg);
    color: var(--text-faint);
    border-radius: 10px;
  }

  /* â”€â”€ Demo list â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .demo-list {
    display: none;
    border-top: 1px solid var(--border);
  }
  .week-card.open .demo-list { display: block; }

  .demo-item {
    padding: 12px 18px;
    border-bottom: 1px solid var(--border);
    display: flex;
    gap: 14px;
    align-items: flex-start;
    transition: background 0.15s;
  }
  .demo-item:last-child { border-bottom: none; }
  .demo-item:hover { background: var(--surface2); }
  .demo-item.highlight { background: rgba(124, 106, 247, 0.07); }

  .demo-thumb {
    flex-shrink: 0;
    width: 80px;
    height: 45px;
    border-radius: 5px;
    background: var(--surface2);
    overflow: hidden;
    position: relative;
  }
  .demo-thumb img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }
  .demo-thumb .play-icon {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(0,0,0,0.35);
    opacity: 0;
    transition: opacity 0.15s;
    font-size: 16px;
  }
  .demo-item:hover .demo-thumb .play-icon { opacity: 1; }
  .demo-thumb-placeholder {
    width: 100%;
    height: 100%;
    background: var(--surface2);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-faint);
    font-size: 18px;
  }

  .demo-body { flex: 1; min-width: 0; }
  .demo-title {
    font-size: 13px;
    font-weight: 500;
    color: var(--text);
    margin-bottom: 3px;
    line-height: 1.4;
  }
  .demo-title a {
    color: inherit;
    text-decoration: none;
  }
  .demo-title a:hover { color: var(--accent); }

  .demo-desc {
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.5;
    margin-bottom: 6px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .demo-desc.expanded { -webkit-line-clamp: unset; }

  .demo-footer {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
  }
  .demo-author {
    font-size: 11px;
    color: var(--accent2);
    font-weight: 500;
    cursor: pointer;
  }
  .demo-author:hover { text-decoration: underline; }
  .demo-tag {
    font-size: 10px;
    padding: 1px 7px;
    background: var(--tag-bg);
    color: var(--tag-text);
    border-radius: 10px;
  }
  .demo-expand-btn {
    margin-left: auto;
    font-size: 10px;
    color: var(--text-faint);
    cursor: pointer;
    background: none;
    border: none;
    font-family: inherit;
    padding: 0;
  }
  .demo-expand-btn:hover { color: var(--accent2); }

  /* â”€â”€ Changelog item â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .changelog-item {
    padding: 10px 18px;
    border-bottom: 1px solid var(--border);
    font-size: 12.5px;
    color: var(--text-muted);
    line-height: 1.55;
    display: flex;
    gap: 10px;
  }
  .changelog-item:last-child { border-bottom: none; }
  .changelog-item:hover { background: var(--surface2); color: var(--text); }
  .changelog-date {
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    color: var(--text-faint);
    flex-shrink: 0;
    padding-top: 2px;
    min-width: 70px;
  }

  /* â”€â”€ Week summary bullets â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .week-summary {
    padding: 12px 18px;
    border-bottom: 1px solid var(--border);
    background: rgba(0,0,0,0.2);
  }
  .week-summary ul {
    padding-left: 16px;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }
  .week-summary li {
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.5;
  }

  /* â”€â”€ Empty state â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .empty-state {
    text-align: center;
    padding: 80px 20px;
    color: var(--text-faint);
  }
  .empty-state .big { font-size: 40px; margin-bottom: 12px; }
  .empty-state p { font-size: 14px; }

  /* â”€â”€ Loading â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .loading {
    text-align: center;
    padding: 60px;
    color: var(--text-faint);
    font-family: 'DM Mono', monospace;
    font-size: 13px;
  }
  .loading::after {
    content: '...';
    animation: dots 1.2s steps(3, end) infinite;
  }
  @keyframes dots {
    0%   { content: '.'; }
    33%  { content: '..'; }
    66%  { content: '...'; }
  }

  /* â”€â”€ Scrollbar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 3px; }

  /* â”€â”€ Responsive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  @media (max-width: 768px) {
    .app { grid-template-columns: 1fr; }
    .sidebar { display: none; }
    .main { padding: 16px; }
  }
</style>
</head>
<body>
<div class="app" id="app">

  <!-- Topbar -->
  <header class="topbar">
    <div class="logo">omni<em>.</em>tracker</div>
    <div class="topbar-search">
      <span class="search-icon">âŒ•</span>
      <input type="text" id="searchInput" placeholder="Search demos, changelog, authorsâ€¦" autocomplete="off">
    </div>
    <div class="topbar-tabs">
      <button class="topbar-tab active" data-tab="demos" onclick="switchTab('demos')">ğŸ¬ Demos</button>
      <button class="topbar-tab" data-tab="changelog" onclick="switchTab('changelog')">ğŸ“‹ Changelog</button>
    </div>
    <div class="scrape-badge" id="scrapeBadge">loadingâ€¦</div>
  </header>

  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <!-- Stats -->
    <div class="sidebar-section">
      <span class="sidebar-label">Overview</span>
      <div id="sidebarStats" style="display:flex;flex-direction:column;gap:8px;">
        <div class="stat"><span class="stat-value" id="statVideos">â€”</span><span class="stat-label">Videos</span></div>
        <div class="stat"><span class="stat-value" id="statWeeks">â€”</span><span class="stat-label">Demo Weeks</span></div>
        <div class="stat"><span class="stat-value" id="statAuthors">â€”</span><span class="stat-label">Authors</span></div>
      </div>
    </div>

    <!-- Author filter -->
    <div class="sidebar-section" id="authorSection">
      <span class="sidebar-label">Filter by Author</span>
      <div class="author-pills" id="authorPills"></div>
    </div>

    <!-- Tag filter -->
    <div class="sidebar-section" id="tagSection">
      <span class="sidebar-label">Filter by Tag</span>
      <div class="tag-pills" id="tagPills"></div>
    </div>

    <div style="padding: 0 16px;">
      <button class="clear-filters" id="clearFiltersBtn" onclick="clearAllFilters()">âœ• Clear all filters</button>
    </div>
  </aside>

  <!-- Main -->
  <main class="main" id="mainContent">
    <div class="loading" id="loadingMsg">Loading</div>
  </main>

</div>

<script>
// â”€â”€ Config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const DEMOS_URL     = "https://drea-omni.github.io/omni-tracker/data/omni_demos.json";
const CHANGELOG_URL = "https://drea-omni.github.io/omni-tracker/data/omni_changelog.json";

// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let demosData     = null;
let changelogData = null;
let activeTab     = 'demos';
let activeAuthor  = null;
let activeTag     = null;
let searchQuery   = '';

// â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function init() {
  try {
    const [dm, cl] = await Promise.all([
      fetch(DEMOS_URL).then(r => r.json()),
      fetch(CHANGELOG_URL).then(r => r.json()),
    ]);
    demosData     = dm;
    changelogData = cl;

    document.getElementById('scrapeBadge').textContent =
      'scraped ' + (dm.meta?.last_scraped?.slice(0,10) || 'â€”');

    buildSidebar();
    renderDemos();
  } catch (e) {
    document.getElementById('loadingMsg').textContent =
      'âš  Could not load data. Check the console.';
    console.error(e);
  }
}

// â”€â”€ Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildSidebar() {
  if (!demosData) return;

  // Collect author â†’ count map
  const authorCounts = {};
  const tagCounts    = {};

  for (const week of demosData.weeks_detail || []) {
    for (const v of week.videos || []) {
      if (v.author) authorCounts[v.author] = (authorCounts[v.author] || 0) + 1;
      if (v.tag)    tagCounts[v.tag]       = (tagCounts[v.tag]       || 0) + 1;
    }
  }

  // Stats
  const totalVideos  = demosData.meta?.total_videos_indexed || 0;
  const totalWeeks   = (demosData.weeks_detail || []).length;
  const totalAuthors = Object.keys(authorCounts).length;
  document.getElementById('statVideos').textContent  = totalVideos;
  document.getElementById('statWeeks').textContent   = totalWeeks;
  document.getElementById('statAuthors').textContent = totalAuthors;

  // Author pills (sorted by count desc)
  const authors = Object.entries(authorCounts)
    .sort((a, b) => b[1] - a[1]);

  const authorPills = document.getElementById('authorPills');
  authorPills.innerHTML = '';
  for (const [name, count] of authors) {
    const initials = name.split(' ').map(w => w[0]).join('').slice(0,2).toUpperCase();
    const btn = document.createElement('button');
    btn.className = 'author-pill';
    btn.dataset.author = name;
    btn.innerHTML = `
      <span class="author-avatar">${initials}</span>
      <span>${name}</span>
      <span class="author-count">${count}</span>
    `;
    btn.addEventListener('click', () => toggleAuthor(name));
    authorPills.appendChild(btn);
  }

  // Tag pills (sorted by count desc)
  const tags = Object.entries(tagCounts).sort((a, b) => b[1] - a[1]);
  const tagPills = document.getElementById('tagPills');
  tagPills.innerHTML = '';
  for (const [tag, count] of tags) {
    const btn = document.createElement('button');
    btn.className = 'tag-pill';
    btn.dataset.tag = tag;
    btn.textContent = `${tag} ${count}`;
    btn.addEventListener('click', () => toggleTag(tag));
    tagPills.appendChild(btn);
  }
}

// â”€â”€ Filter toggles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleAuthor(name) {
  activeAuthor = activeAuthor === name ? null : name;
  document.querySelectorAll('.author-pill').forEach(p => {
    p.classList.toggle('active', p.dataset.author === activeAuthor);
  });
  updateClearBtn();
  renderDemos();
}

function toggleTag(tag) {
  activeTag = activeTag === tag ? null : tag;
  document.querySelectorAll('.tag-pill').forEach(p => {
    p.classList.toggle('active', p.dataset.tag === activeTag);
  });
  updateClearBtn();
  renderDemos();
}

function clearAllFilters() {
  activeAuthor = null;
  activeTag    = null;
  document.querySelectorAll('.author-pill, .tag-pill').forEach(p => p.classList.remove('active'));
  updateClearBtn();
  if (activeTab === 'demos') renderDemos();
  else renderChangelog();
}

function updateClearBtn() {
  const btn = document.getElementById('clearFiltersBtn');
  btn.classList.toggle('visible', !!(activeAuthor || activeTag || searchQuery));
}

// â”€â”€ Search â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('searchInput').addEventListener('input', e => {
  searchQuery = e.target.value.toLowerCase().trim();
  updateClearBtn();
  if (activeTab === 'demos') renderDemos();
  else renderChangelog();
});

// â”€â”€ Tab switch â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function switchTab(tab) {
  activeTab = tab;
  document.querySelectorAll('.topbar-tab').forEach(t => {
    t.classList.toggle('active', t.dataset.tab === tab);
  });
  document.getElementById('authorSection').style.display = tab === 'demos' ? '' : 'none';
  document.getElementById('tagSection').style.display    = tab === 'demos' ? '' : 'none';

  if (tab === 'demos') renderDemos();
  else renderChangelog();
}

// â”€â”€ Render Demos â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderDemos() {
  if (!demosData) return;
  const main = document.getElementById('mainContent');

  const weeks = (demosData.weeks_detail || [])
    .slice()
    .sort((a, b) => (b.date || '').localeCompare(a.date || ''));

  let totalShown = 0;
  const cards    = [];

  for (const week of weeks) {
    // Filter videos
    const videos = (week.videos || []).filter(v => {
      if (activeAuthor && v.author !== activeAuthor) return false;
      if (activeTag    && v.tag    !== activeTag)    return false;
      if (searchQuery) {
        const haystack = [v.title, v.description, v.author, v.tag]
          .join(' ').toLowerCase();
        if (!haystack.includes(searchQuery)) return false;
      }
      return true;
    });

    if (videos.length === 0) continue;
    totalShown += videos.length;

    const weekDate  = week.date || '';
    const weekTitle = week.title && week.title !== 'Demos'
      ? week.title
      : (demosData.index || []).find(e => e.url === week.url)?.title || weekDate;

    const allAuthors = [...new Set(videos.map(v => v.author).filter(Boolean))];
    const allTags    = [...new Set(videos.map(v => v.tag).filter(Boolean))];

    // Summary bullets
    const bullets = week.summary_bullets || [];

    let demoItemsHTML = '';
    for (const v of videos) {
      const hasThumb = !!v.youtube_id;
      const thumbHTML = hasThumb
        ? `<img src="${v.thumbnail || `https://img.youtube.com/vi/${v.youtube_id}/mqdefault.jpg`}"
               alt="" loading="lazy" onerror="this.parentElement.innerHTML='<div class=demo-thumb-placeholder>â–¶</div>'">
           <div class="play-icon">â–¶</div>`
        : `<div class="demo-thumb-placeholder">â–¶</div>`;

      const videoURL = v.youtube_url || (v.youtube_id ? `https://www.youtube.com/watch?v=${v.youtube_id}` : '#');
      const descHTML = v.description
        ? `<div class="demo-desc">${escHtml(v.description)}</div>`
        : '';
      const expandBtn = v.description && v.description.length > 120
        ? `<button class="demo-expand-btn" onclick="toggleDesc(this)">show more</button>`
        : '';
      const authorHTML = v.author
        ? `<span class="demo-author" onclick="toggleAuthor('${escHtml(v.author)}')">${escHtml(v.author)}</span>`
        : '';
      const tagHTML = v.tag
        ? `<span class="demo-tag">${escHtml(v.tag)}</span>`
        : '';

      const isHighlight = activeAuthor && v.author === activeAuthor;

      demoItemsHTML += `
        <div class="demo-item${isHighlight ? ' highlight' : ''}">
          <a href="${videoURL}" target="_blank" rel="noopener" class="demo-thumb">${thumbHTML}</a>
          <div class="demo-body">
            <div class="demo-title">
              <a href="${videoURL}" target="_blank" rel="noopener">${escHtml(v.title || 'Untitled')}</a>
            </div>
            ${descHTML}
            <div class="demo-footer">
              ${authorHTML}
              ${tagHTML}
              ${expandBtn}
            </div>
          </div>
        </div>`;
    }

    const summaryHTML = bullets.length
      ? `<div class="week-summary"><ul>${bullets.map(b => `<li>${escHtml(b)}</li>`).join('')}</ul></div>`
      : '';

    const authorsPreview = allAuthors.slice(0, 4).map(a =>
      `<span class="mini-author">${escHtml(a)}</span>`
    ).join('') + (allAuthors.length > 4 ? `<span class="mini-author">+${allAuthors.length - 4}</span>` : '');

    cards.push(`
      <div class="week-card" data-week="${escHtml(weekDate)}">
        <div class="week-header" onclick="toggleWeek(this.parentElement)">
          <span class="week-date">${weekDate}</span>
          <span class="week-title">${escHtml(weekTitle)}</span>
          <div class="week-meta">
            <div class="week-authors-preview">${authorsPreview}</div>
            <span class="week-count">${videos.length} video${videos.length !== 1 ? 's' : ''}</span>
            <span class="chevron">â€º</span>
          </div>
        </div>
        <div class="demo-list">
          ${summaryHTML}
          ${demoItemsHTML}
        </div>
      </div>`);
  }

  const resultMeta = `<div class="result-meta"><strong>${totalShown}</strong> videos across <strong>${cards.length}</strong> weeks${activeAuthor ? ` Â· author: <strong>${activeAuthor}</strong>` : ''}${activeTag ? ` Â· tag: <strong>${activeTag}</strong>` : ''}${searchQuery ? ` Â· search: <strong>"${searchQuery}"</strong>` : ''}</div>`;

  if (cards.length === 0) {
    main.innerHTML = `<div class="empty-state"><div class="big">ğŸ”</div><p>No demos match your filters.</p></div>`;
    return;
  }

  main.innerHTML = resultMeta + cards.join('');

  // Auto-open first card if filtered
  if (activeAuthor || activeTag || searchQuery) {
    const first = main.querySelector('.week-card');
    if (first) first.classList.add('open');
  }
}

// â”€â”€ Render Changelog â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderChangelog() {
  if (!changelogData) return;
  const main = document.getElementById('mainContent');

  const weeks = (changelogData.weeks || [])
    .slice()
    .sort((a, b) => (b.week_start || '').localeCompare(a.week_start || ''));

  const cards = [];
  let totalShown = 0;

  for (const week of weeks) {
    const allItems = (week.days || []).flatMap(d =>
      (d.items || []).map(item => ({ date: d.date, item }))
    );

    const filtered = allItems.filter(({ item }) => {
      if (!searchQuery) return true;
      return item.toLowerCase().includes(searchQuery);
    });

    if (filtered.length === 0) continue;
    totalShown += filtered.length;

    const itemsHTML = filtered.map(({ date, item }) => `
      <div class="changelog-item">
        <span class="changelog-date">${date?.slice(5) || ''}</span>
        <span>${escHtml(item)}</span>
      </div>`).join('');

    cards.push(`
      <div class="week-card" data-week="${week.week_start || ''}">
        <div class="week-header" onclick="toggleWeek(this.parentElement)">
          <span class="week-date">${week.week_start || ''}</span>
          <span class="week-title">${escHtml(week.week_label || '')}</span>
          <div class="week-meta">
            <span class="week-count">${filtered.length} item${filtered.length !== 1 ? 's' : ''}</span>
            <span class="chevron">â€º</span>
          </div>
        </div>
        <div class="demo-list">${itemsHTML}</div>
      </div>`);
  }

  const resultMeta = `<div class="result-meta"><strong>${totalShown}</strong> entries across <strong>${cards.length}</strong> weeks${searchQuery ? ` Â· "<strong>${searchQuery}</strong>"` : ''}</div>`;

  if (cards.length === 0) {
    main.innerHTML = `<div class="empty-state"><div class="big">ğŸ”</div><p>No changelog entries match.</p></div>`;
    return;
  }

  main.innerHTML = resultMeta + cards.join('');

  // Auto-open first (most recent) card
  const first = main.querySelector('.week-card');
  if (first) first.classList.add('open');
}

// â”€â”€ Interactions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleWeek(card) {
  card.classList.toggle('open');
}

function toggleDesc(btn) {
  const desc = btn.closest('.demo-body').querySelector('.demo-desc');
  if (!desc) return;
  desc.classList.toggle('expanded');
  btn.textContent = desc.classList.contains('expanded') ? 'show less' : 'show more';
}

function escHtml(str) {
  if (!str) return '';
  return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

// â”€â”€ Boot â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
init();
</script>
</body>
</html>
